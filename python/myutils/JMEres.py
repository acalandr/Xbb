import ROOT

class JMEres(object):
    def __init__(self, year):
        self.year = year
        if self.year == 2017:
            # from https://github.com/cms-jet/JRDatabase/blob/master/textFiles/Fall17_V3_DATA/Fall17_V3_DATA_PtResolution_AK4PFchs.txt 
            self.table = [
                [-4.7,-3.2,0,6.37,6,15,3000,-29.87,29.84,0.1045,-1.995],
                [-4.7,-3.2,6.37,12.4,6,15,3000,-23.2,23.09,0.1051,-1.987],
                [-4.7,-3.2,12.4,18.42,6,15,3000,4.337,0.2253,0.06986,-0.4215],
                [-4.7,-3.2,18.42,24.45,6,15,3000,4.088,2.746,0.1136,-1.959],
                [-4.7,-3.2,24.45,30.47,6,15,3000,5.624,0.1291,0.002663,-0.04825],
                [-4.7,-3.2,30.47,36.49,6,15,3000,6.152,6.125e-05,0.1128,-1.319],
                [-4.7,-3.2,36.49,42.52,6,15,3000,6.235,0.1408,0.0001266,-0.08163],
                [-3.2,-3,0,6.37,6,15,3000,-35.12,35.21,0.1466,-1.993],
                [-3.2,-3,6.37,12.4,6,15,3000,6.573,0.2026,6.573e-05,-0.1564],
                [-3.2,-3,12.4,18.42,6,15,3000,0.004144,6.019,0.1549,-1.854],
                [-3.2,-3,18.42,24.45,6,15,3000,8.341,0.0001012,0.1526,-1.689],
                [-3.2,-3,24.45,30.47,6,15,3000,9.115,0.0002242,0.1518,-1.362],
                [-3.2,-3,30.47,36.49,6,15,3000,9.86,-2.112e-05,0.1438,-1.114],
                [-3.2,-3,36.49,42.52,6,15,3000,10.45,0.0001536,0.1398,-1.271],
                [-3,-2.8,0,6.37,6,15,3000,6.048,0.1992,-3.559e-06,-0.2953],
                [-3,-2.8,6.37,12.4,6,15,3000,6.867,0.2036,1.946e-05,-0.3068],
                [-3,-2.8,12.4,18.42,6,15,3000,8.198,0.0001314,0.08772,-1.252],
                [-3,-2.8,18.42,24.45,6,15,3000,8.756,0.134,-0.07197,-0.2968],
                [-3,-2.8,24.45,30.47,6,15,3000,9.615,0.0001533,-0.08793,-1.445],
                [-3,-2.8,30.47,36.49,6,15,3000,10.01,0.1524,3.815e-05,-0.2422],
                [-3,-2.8,36.49,42.52,6,15,3000,10.05,0.1932,0.0001734,-0.2739],
                [-2.8,-2.5,0,6.37,6,15,3000,6.114,0.2385,1.741e-05,-0.5054],
                [-2.8,-2.5,6.37,12.4,6,15,3000,6.931,0.1964,7.465e-06,-0.4335],
                [-2.8,-2.5,12.4,18.42,6,15,3000,7.858,0.2435,6.026e-07,-0.5235],
                [-2.8,-2.5,18.42,24.45,6,15,3000,8.713,0.1314,8.441e-06,-0.3028],
                [-2.8,-2.5,24.45,30.47,6,15,3000,9.413,0.2792,1.217e-06,-0.5729],
                [-2.8,-2.5,30.47,36.49,6,15,3000,10.51,0.1659,1.277e-06,-0.4276],
                [-2.8,-2.5,36.49,42.52,6,15,3000,11.77,8.547e-07,0.05169,-1.197],
                [-2.5,-2.3,0,6.37,6,15,3000,3.639,0.6502,-0.01427,-0.8624],
                [-2.5,-2.3,6.37,12.4,6,15,3000,2.391,1.635,-0.0378,-1.251],
                [-2.5,-2.3,12.4,18.42,6,15,3000,3.431,1.985,0.04609,-1.359],
                [-2.5,-2.3,18.42,24.45,6,15,3000,5.095,0.8757,-0.02736,-0.9761],
                [-2.5,-2.3,24.45,30.47,6,15,3000,5.034,1.479,-0.03479,-1.175],
                [-2.5,-2.3,30.47,36.49,6,15,3000,6.694,1.325,0.03374,-1.101],
                [-2.5,-2.3,36.49,42.52,6,15,3000,7.444,1.137,4.258e-05,-0.9531],
                [-2.3,-2.1,0,6.37,6,15,3000,1.947,0.9639,-0.02799,-1.024],
                [-2.3,-2.1,6.37,12.4,6,15,3000,2.643,0.9054,-0.02701,-0.9753],
                [-2.3,-2.1,12.4,18.42,6,15,3000,-3.209,2.521,-0.04442,-1.385],
                [-2.3,-2.1,18.42,24.45,6,15,3000,-5.368,3.81,-0.04587,-1.525],
                [-2.3,-2.1,24.45,30.47,6,15,3000,-2.344,2.207,0.03446,-1.265],
                [-2.3,-2.1,30.47,36.49,6,15,3000,-11.01,8.354,0.05639,-1.706],
                [-2.3,-2.1,36.49,42.52,6,15,3000,6.282,1.064,8.482e-06,-0.8687],
                [-2.1,-1.9,0,6.37,6,15,3000,-1.979,1.193,-0.03497,-1.109],
                [-2.1,-1.9,6.37,12.4,6,15,3000,-2.528,1.44,-0.03273,-1.143],
                [-2.1,-1.9,12.4,18.42,6,15,3000,1.95,1.118,-0.03202,-1.054],
                [-2.1,-1.9,18.42,24.45,6,15,3000,2.377,1.166,-0.03593,-1.061],
                [-2.1,-1.9,24.45,30.47,6,15,3000,3.122,1.107,-0.0292,-1.005],
                [-2.1,-1.9,30.47,36.49,6,15,3000,-1.899,1.944,0.03736,-1.185],
                [-2.1,-1.9,36.49,42.52,6,15,3000,4.168,1.452,0.03836,-1.019],
                [-1.9,-1.7,0,6.37,6,15,3000,1.227,0.8407,-0.0232,-0.9284],
                [-1.9,-1.7,6.37,12.4,6,15,3000,-1.339,1.218,-0.03479,-1.076],
                [-1.9,-1.7,12.4,18.42,6,15,3000,-2.011,1.435,-0.03565,-1.124],
                [-1.9,-1.7,18.42,24.45,6,15,3000,3.324,0.8102,-0.02662,-0.8923],
                [-1.9,-1.7,24.45,30.47,6,15,3000,2.188,1.365,-0.0375,-1.088],
                [-1.9,-1.7,30.47,36.49,6,15,3000,2.884,1.306,0.03685,-1.038],
                [-1.9,-1.7,36.49,42.52,6,15,3000,4.03,1.141,0.03059,-0.9262],
                [-1.7,-1.3,0,6.37,6,15,3000,-1.469,0.9562,0.05101,-0.955],
                [-1.7,-1.3,6.37,12.4,6,15,3000,-1.377,1.078,0.05427,-1.003],
                [-1.7,-1.3,12.4,18.42,6,15,3000,1.501,1.072,0.05498,-1.001],
                [-1.7,-1.3,18.42,24.45,6,15,3000,1.53,1.158,0.05396,-1.021],
                [-1.7,-1.3,24.45,30.47,6,15,3000,1.621,1.358,0.0578,-1.078],
                [-1.7,-1.3,30.47,36.49,6,15,3000,3.163,1.131,0.05725,-0.9809],
                [-1.7,-1.3,36.49,42.52,6,15,3000,2.818,1.326,0.05893,-0.9977],
                [-1.3,-1.1,0,6.37,6,15,3000,0.6707,0.5839,0.04697,-0.752],
                [-1.3,-1.1,6.37,12.4,6,15,3000,1.395,0.6702,0.0496,-0.8152],
                [-1.3,-1.1,12.4,18.42,6,15,3000,2.43,0.5712,0.04572,-0.7345],
                [-1.3,-1.1,18.42,24.45,6,15,3000,2.439,0.6623,0.04496,-0.7771],
                [-1.3,-1.1,24.45,30.47,6,15,3000,3.353,0.5924,0.04617,-0.7384],
                [-1.3,-1.1,30.47,36.49,6,15,3000,3.465,0.7579,0.05328,-0.8435],
                [-1.3,-1.1,36.49,42.52,6,15,3000,1.982,1.148,0.05664,-0.9626],
                [-1.1,-0.8,0,6.37,6,15,3000,-0.8118,0.491,0.03583,-0.7149],
                [-1.1,-0.8,6.37,12.4,6,15,3000,1.289,0.49,0.03539,-0.7073],
                [-1.1,-0.8,12.4,18.42,6,15,3000,1.953,0.5161,0.03658,-0.7295],
                [-1.1,-0.8,18.42,24.45,6,15,3000,2.347,0.5396,0.03576,-0.7339],
                [-1.1,-0.8,24.45,30.47,6,15,3000,2.794,0.5687,0.03825,-0.7602],
                [-1.1,-0.8,30.47,36.49,6,15,3000,2.796,0.7203,0.04074,-0.8431],
                [-1.1,-0.8,36.49,42.52,6,15,3000,3.788,0.6287,0.04156,-0.7959],
                [-0.8,-0.5,0,6.37,6,15,3000,-0.9395,0.4556,0.02738,-0.6909],
                [-0.8,-0.5,6.37,12.4,6,15,3000,1.339,0.4621,0.02785,-0.6965],
                [-0.8,-0.5,12.4,18.42,6,15,3000,1.597,0.5254,0.02952,-0.7407],
                [-0.8,-0.5,18.42,24.45,6,15,3000,2.527,0.5042,0.02842,-0.723],
                [-0.8,-0.5,24.45,30.47,6,15,3000,2.896,0.5428,0.03001,-0.7476],
                [-0.8,-0.5,30.47,36.49,6,15,3000,3.514,0.5437,0.03055,-0.7486],
                [-0.8,-0.5,36.49,42.52,6,15,3000,3.678,0.6372,0.03325,-0.8053],
                [-0.5,0,0,6.37,6,15,3000,-1.515,0.5971,0.03046,-0.7901],
                [-0.5,0,6.37,12.4,6,15,3000,-0.7966,0.6589,0.03119,-0.8237],
                [-0.5,0,12.4,18.42,6,15,3000,1.387,0.6885,0.03145,-0.8378],
                [-0.5,0,18.42,24.45,6,15,3000,2.151,0.7185,0.03168,-0.8502],
                [-0.5,0,24.45,30.47,6,15,3000,2.73,0.7361,0.03184,-0.8548],
                [-0.5,0,30.47,36.49,6,15,3000,3.603,0.7318,0.03227,-0.855],
                [-0.5,0,36.49,42.52,6,15,3000,3.897,0.7882,0.03282,-0.8746],
                [0,0.5,0,6.37,6,15,3000,-1.515,0.5971,0.03046,-0.7901],
                [0,0.5,6.37,12.4,6,15,3000,-0.7966,0.6589,0.03119,-0.8237],
                [0,0.5,12.4,18.42,6,15,3000,1.387,0.6885,0.03145,-0.8378],
                [0,0.5,18.42,24.45,6,15,3000,2.151,0.7185,0.03168,-0.8502],
                [0,0.5,24.45,30.47,6,15,3000,2.73,0.7361,0.03184,-0.8548],
                [0,0.5,30.47,36.49,6,15,3000,3.603,0.7318,0.03227,-0.855],
                [0,0.5,36.49,42.52,6,15,3000,3.897,0.7882,0.03282,-0.8746],
                [0.5,0.8,0,6.37,6,15,3000,-0.9395,0.4556,0.02738,-0.6909],
                [0.5,0.8,6.37,12.4,6,15,3000,1.339,0.4621,0.02785,-0.6965],
                [0.5,0.8,12.4,18.42,6,15,3000,1.597,0.5254,0.02952,-0.7407],
                [0.5,0.8,18.42,24.45,6,15,3000,2.527,0.5042,0.02842,-0.723],
                [0.5,0.8,24.45,30.47,6,15,3000,2.896,0.5428,0.03001,-0.7476],
                [0.5,0.8,30.47,36.49,6,15,3000,3.514,0.5437,0.03055,-0.7486],
                [0.5,0.8,36.49,42.52,6,15,3000,3.678,0.6372,0.03325,-0.8053],
                [0.8,1.1,0,6.37,6,15,3000,-0.8118,0.491,0.03583,-0.7149],
                [0.8,1.1,6.37,12.4,6,15,3000,1.289,0.49,0.03539,-0.7073],
                [0.8,1.1,12.4,18.42,6,15,3000,1.953,0.5161,0.03658,-0.7295],
                [0.8,1.1,18.42,24.45,6,15,3000,2.347,0.5396,0.03576,-0.7339],
                [0.8,1.1,24.45,30.47,6,15,3000,2.794,0.5687,0.03825,-0.7602],
                [0.8,1.1,30.47,36.49,6,15,3000,2.796,0.7203,0.04074,-0.8431],
                [0.8,1.1,36.49,42.52,6,15,3000,3.788,0.6287,0.04156,-0.7959],
                [1.1,1.3,0,6.37,6,15,3000,0.6707,0.5839,0.04697,-0.752],
                [1.1,1.3,6.37,12.4,6,15,3000,1.395,0.6702,0.0496,-0.8152],
                [1.1,1.3,12.4,18.42,6,15,3000,2.43,0.5712,0.04572,-0.7345],
                [1.1,1.3,18.42,24.45,6,15,3000,2.439,0.6623,0.04496,-0.7771],
                [1.1,1.3,24.45,30.47,6,15,3000,3.353,0.5924,0.04617,-0.7384],
                [1.1,1.3,30.47,36.49,6,15,3000,3.465,0.7579,0.05328,-0.8435],
                [1.1,1.3,36.49,42.52,6,15,3000,1.982,1.148,0.05664,-0.9626],
                [1.3,1.7,0,6.37,6,15,3000,-1.469,0.9562,0.05101,-0.955],
                [1.3,1.7,6.37,12.4,6,15,3000,-1.377,1.078,0.05427,-1.003],
                [1.3,1.7,12.4,18.42,6,15,3000,1.501,1.072,0.05498,-1.001],
                [1.3,1.7,18.42,24.45,6,15,3000,1.53,1.158,0.05396,-1.021],
                [1.3,1.7,24.45,30.47,6,15,3000,1.621,1.358,0.0578,-1.078],
                [1.3,1.7,30.47,36.49,6,15,3000,3.163,1.131,0.05725,-0.9809],
                [1.3,1.7,36.49,42.52,6,15,3000,2.818,1.326,0.05893,-0.9977],
                [1.7,1.9,0,6.37,6,15,3000,1.227,0.8407,-0.0232,-0.9284],
                [1.7,1.9,6.37,12.4,6,15,3000,-1.339,1.218,-0.03479,-1.076],
                [1.7,1.9,12.4,18.42,6,15,3000,-2.011,1.435,-0.03565,-1.124],
                [1.7,1.9,18.42,24.45,6,15,3000,3.324,0.8102,-0.02662,-0.8923],
                [1.7,1.9,24.45,30.47,6,15,3000,2.188,1.365,-0.0375,-1.088],
                [1.7,1.9,30.47,36.49,6,15,3000,2.884,1.306,0.03685,-1.038],
                [1.7,1.9,36.49,42.52,6,15,3000,4.03,1.141,0.03059,-0.9262],
                [1.9,2.1,0,6.37,6,15,3000,-1.979,1.193,-0.03497,-1.109],
                [1.9,2.1,6.37,12.4,6,15,3000,-2.528,1.44,-0.03273,-1.143],
                [1.9,2.1,12.4,18.42,6,15,3000,1.95,1.118,-0.03202,-1.054],
                [1.9,2.1,18.42,24.45,6,15,3000,2.377,1.166,-0.03593,-1.061],
                [1.9,2.1,24.45,30.47,6,15,3000,3.122,1.107,-0.0292,-1.005],
                [1.9,2.1,30.47,36.49,6,15,3000,-1.899,1.944,0.03736,-1.185],
                [1.9,2.1,36.49,42.52,6,15,3000,4.168,1.452,0.03836,-1.019],
                [2.1,2.3,0,6.37,6,15,3000,1.947,0.9639,-0.02799,-1.024],
                [2.1,2.3,6.37,12.4,6,15,3000,2.643,0.9054,-0.02701,-0.9753],
                [2.1,2.3,12.4,18.42,6,15,3000,-3.209,2.521,-0.04442,-1.385],
                [2.1,2.3,18.42,24.45,6,15,3000,-5.368,3.81,-0.04587,-1.525],
                [2.1,2.3,24.45,30.47,6,15,3000,-2.344,2.207,0.03446,-1.265],
                [2.1,2.3,30.47,36.49,6,15,3000,-11.01,8.354,0.05639,-1.706],
                [2.1,2.3,36.49,42.52,6,15,3000,6.282,1.064,8.482e-06,-0.8687],
                [2.3,2.5,0,6.37,6,15,3000,3.639,0.6502,-0.01427,-0.8624],
                [2.3,2.5,6.37,12.4,6,15,3000,2.391,1.635,-0.0378,-1.251],
                [2.3,2.5,12.4,18.42,6,15,3000,3.431,1.985,0.04609,-1.359],
                [2.3,2.5,18.42,24.45,6,15,3000,5.095,0.8757,-0.02736,-0.9761],
                [2.3,2.5,24.45,30.47,6,15,3000,5.034,1.479,-0.03479,-1.175],
                [2.3,2.5,30.47,36.49,6,15,3000,6.694,1.325,0.03374,-1.101],
                [2.3,2.5,36.49,42.52,6,15,3000,7.444,1.137,4.258e-05,-0.9531],
                [2.5,2.8,0,6.37,6,15,3000,6.114,0.2385,1.741e-05,-0.5054],
                [2.5,2.8,6.37,12.4,6,15,3000,6.931,0.1964,7.465e-06,-0.4335],
                [2.5,2.8,12.4,18.42,6,15,3000,7.858,0.2435,6.026e-07,-0.5235],
                [2.5,2.8,18.42,24.45,6,15,3000,8.713,0.1314,8.441e-06,-0.3028],
                [2.5,2.8,24.45,30.47,6,15,3000,9.413,0.2792,1.217e-06,-0.5729],
                [2.5,2.8,30.47,36.49,6,15,3000,10.51,0.1659,1.277e-06,-0.4276],
                [2.5,2.8,36.49,42.52,6,15,3000,11.77,8.547e-07,0.05169,-1.197],
                [2.8,3,0,6.37,6,15,3000,6.048,0.1992,-3.559e-06,-0.2953],
                [2.8,3,6.37,12.4,6,15,3000,6.867,0.2036,1.946e-05,-0.3068],
                [2.8,3,12.4,18.42,6,15,3000,8.198,0.0001314,0.08772,-1.252],
                [2.8,3,18.42,24.45,6,15,3000,8.756,0.134,-0.07197,-0.2968],
                [2.8,3,24.45,30.47,6,15,3000,9.615,0.0001533,-0.08793,-1.445],
                [2.8,3,30.47,36.49,6,15,3000,10.01,0.1524,3.815e-05,-0.2422],
                [2.8,3,36.49,42.52,6,15,3000,10.05,0.1932,0.0001734,-0.2739],
                [3,3.2,0,6.37,6,15,3000,-35.12,35.21,0.1466,-1.993],
                [3,3.2,6.37,12.4,6,15,3000,6.573,0.2026,6.573e-05,-0.1564],
                [3,3.2,12.4,18.42,6,15,3000,0.004144,6.019,0.1549,-1.854],
                [3,3.2,18.42,24.45,6,15,3000,8.341,0.0001012,0.1526,-1.689],
                [3,3.2,24.45,30.47,6,15,3000,9.115,0.0002242,0.1518,-1.362],
                [3,3.2,30.47,36.49,6,15,3000,9.86,-2.112e-05,0.1438,-1.114],
                [3,3.2,36.49,42.52,6,15,3000,10.45,0.0001536,0.1398,-1.271],
                [3.2,4.7,0,6.37,6,15,3000,-29.87,29.84,0.1045,-1.995],
                [3.2,4.7,6.37,12.4,6,15,3000,-23.2,23.09,0.1051,-1.987],
                [3.2,4.7,12.4,18.42,6,15,3000,4.337,0.2253,0.06986,-0.4215],
                [3.2,4.7,18.42,24.45,6,15,3000,4.088,2.746,0.1136,-1.959],
                [3.2,4.7,24.45,30.47,6,15,3000,5.624,0.1291,0.002663,-0.04825],
                [3.2,4.7,30.47,36.49,6,15,3000,6.152,6.125e-05,0.1128,-1.319],
                [3.2,4.7,36.49,42.52,6,15,3000,6.235,0.1408,0.0001266,-0.08163]
                ]
            self.formula =  ROOT.TFormula("f", "sqrt([0]*abs([0])/(x*x)+[1]*[1]*pow(x,[3])+[2]*[2])")
            self.rhoMin = 0.0
            self.rhoMax = 42.52
        elif self.year == 2018:
            #from https://github.com/cms-jet/JRDatabase/blob/master/textFiles/Autumn18_V4_DATA/Autumn18_V4_DATA_PtResolution_AK4PFchs.txt 
            self.table = [
                [-4.7,-3.2,0,6.37,6,15,3000,-29.87,29.84,0.1045,-1.995],
                [-4.7,-3.2,6.37,12.4,6,15,3000,-23.2,23.09,0.1051,-1.987],
                [-4.7,-3.2,12.4,18.42,6,15,3000,4.337,0.2253,0.06986,-0.4215],
                [-4.7,-3.2,18.42,24.45,6,15,3000,4.088,2.746,0.1136,-1.959],
                [-4.7,-3.2,24.45,30.47,6,15,3000,5.624,0.1291,0.002663,-0.04825],
                [-4.7,-3.2,30.47,36.49,6,15,3000,6.152,6.125e-05,0.1128,-1.319],
                [-4.7,-3.2,36.49,42.52,6,15,3000,6.235,0.1408,0.0001266,-0.08163],
                [-3.2,-3,0,6.37,6,15,3000,-35.12,35.21,0.1466,-1.993],
                [-3.2,-3,6.37,12.4,6,15,3000,6.573,0.2026,6.573e-05,-0.1564],
                [-3.2,-3,12.4,18.42,6,15,3000,0.004144,6.019,0.1549,-1.854],
                [-3.2,-3,18.42,24.45,6,15,3000,8.341,0.0001012,0.1526,-1.689],
                [-3.2,-3,24.45,30.47,6,15,3000,9.115,0.0002242,0.1518,-1.362],
                [-3.2,-3,30.47,36.49,6,15,3000,9.86,-2.112e-05,0.1438,-1.114],
                [-3.2,-3,36.49,42.52,6,15,3000,10.45,0.0001536,0.1398,-1.271],
                [-3,-2.8,0,6.37,6,15,3000,6.048,0.1992,-3.559e-06,-0.2953],
                [-3,-2.8,6.37,12.4,6,15,3000,6.867,0.2036,1.946e-05,-0.3068],
                [-3,-2.8,12.4,18.42,6,15,3000,8.198,0.0001314,0.08772,-1.252],
                [-3,-2.8,18.42,24.45,6,15,3000,8.756,0.134,-0.07197,-0.2968],
                [-3,-2.8,24.45,30.47,6,15,3000,9.615,0.0001533,-0.08793,-1.445],
                [-3,-2.8,30.47,36.49,6,15,3000,10.01,0.1524,3.815e-05,-0.2422],
                [-3,-2.8,36.49,42.52,6,15,3000,10.05,0.1932,0.0001734,-0.2739],
                [-2.8,-2.5,0,6.37,6,15,3000,6.114,0.2385,1.741e-05,-0.5054],
                [-2.8,-2.5,6.37,12.4,6,15,3000,6.931,0.1964,7.465e-06,-0.4335],
                [-2.8,-2.5,12.4,18.42,6,15,3000,7.858,0.2435,6.026e-07,-0.5235],
                [-2.8,-2.5,18.42,24.45,6,15,3000,8.713,0.1314,8.441e-06,-0.3028],
                [-2.8,-2.5,24.45,30.47,6,15,3000,9.413,0.2792,1.217e-06,-0.5729],
                [-2.8,-2.5,30.47,36.49,6,15,3000,10.51,0.1659,1.277e-06,-0.4276],
                [-2.8,-2.5,36.49,42.52,6,15,3000,11.77,8.547e-07,0.05169,-1.197],
                [-2.5,-2.3,0,6.37,6,15,3000,3.639,0.6502,-0.01427,-0.8624],
                [-2.5,-2.3,6.37,12.4,6,15,3000,2.391,1.635,-0.0378,-1.251],
                [-2.5,-2.3,12.4,18.42,6,15,3000,3.431,1.985,0.04609,-1.359],
                [-2.5,-2.3,18.42,24.45,6,15,3000,5.095,0.8757,-0.02736,-0.9761],
                [-2.5,-2.3,24.45,30.47,6,15,3000,5.034,1.479,-0.03479,-1.175],
                [-2.5,-2.3,30.47,36.49,6,15,3000,6.694,1.325,0.03374,-1.101],
                [-2.5,-2.3,36.49,42.52,6,15,3000,7.444,1.137,4.258e-05,-0.9531],
                [-2.3,-2.1,0,6.37,6,15,3000,1.947,0.9639,-0.02799,-1.024],
                [-2.3,-2.1,6.37,12.4,6,15,3000,2.643,0.9054,-0.02701,-0.9753],
                [-2.3,-2.1,12.4,18.42,6,15,3000,-3.209,2.521,-0.04442,-1.385],
                [-2.3,-2.1,18.42,24.45,6,15,3000,-5.368,3.81,-0.04587,-1.525],
                [-2.3,-2.1,24.45,30.47,6,15,3000,-2.344,2.207,0.03446,-1.265],
                [-2.3,-2.1,30.47,36.49,6,15,3000,-11.01,8.354,0.05639,-1.706],
                [-2.3,-2.1,36.49,42.52,6,15,3000,6.282,1.064,8.482e-06,-0.8687],
                [-2.1,-1.9,0,6.37,6,15,3000,-1.979,1.193,-0.03497,-1.109],
                [-2.1,-1.9,6.37,12.4,6,15,3000,-2.528,1.44,-0.03273,-1.143],
                [-2.1,-1.9,12.4,18.42,6,15,3000,1.95,1.118,-0.03202,-1.054],
                [-2.1,-1.9,18.42,24.45,6,15,3000,2.377,1.166,-0.03593,-1.061],
                [-2.1,-1.9,24.45,30.47,6,15,3000,3.122,1.107,-0.0292,-1.005],
                [-2.1,-1.9,30.47,36.49,6,15,3000,-1.899,1.944,0.03736,-1.185],
                [-2.1,-1.9,36.49,42.52,6,15,3000,4.168,1.452,0.03836,-1.019],
                [-1.9,-1.7,0,6.37,6,15,3000,1.227,0.8407,-0.0232,-0.9284],
                [-1.9,-1.7,6.37,12.4,6,15,3000,-1.339,1.218,-0.03479,-1.076],
                [-1.9,-1.7,12.4,18.42,6,15,3000,-2.011,1.435,-0.03565,-1.124],
                [-1.9,-1.7,18.42,24.45,6,15,3000,3.324,0.8102,-0.02662,-0.8923],
                [-1.9,-1.7,24.45,30.47,6,15,3000,2.188,1.365,-0.0375,-1.088],
                [-1.9,-1.7,30.47,36.49,6,15,3000,2.884,1.306,0.03685,-1.038],
                [-1.9,-1.7,36.49,42.52,6,15,3000,4.03,1.141,0.03059,-0.9262],
                [-1.7,-1.3,0,6.37,6,15,3000,-1.469,0.9562,0.05101,-0.955],
                [-1.7,-1.3,6.37,12.4,6,15,3000,-1.377,1.078,0.05427,-1.003],
                [-1.7,-1.3,12.4,18.42,6,15,3000,1.501,1.072,0.05498,-1.001],
                [-1.7,-1.3,18.42,24.45,6,15,3000,1.53,1.158,0.05396,-1.021],
                [-1.7,-1.3,24.45,30.47,6,15,3000,1.621,1.358,0.0578,-1.078],
                [-1.7,-1.3,30.47,36.49,6,15,3000,3.163,1.131,0.05725,-0.9809],
                [-1.7,-1.3,36.49,42.52,6,15,3000,2.818,1.326,0.05893,-0.9977],
                [-1.3,-1.1,0,6.37,6,15,3000,0.6707,0.5839,0.04697,-0.752],
                [-1.3,-1.1,6.37,12.4,6,15,3000,1.395,0.6702,0.0496,-0.8152],
                [-1.3,-1.1,12.4,18.42,6,15,3000,2.43,0.5712,0.04572,-0.7345],
                [-1.3,-1.1,18.42,24.45,6,15,3000,2.439,0.6623,0.04496,-0.7771],
                [-1.3,-1.1,24.45,30.47,6,15,3000,3.353,0.5924,0.04617,-0.7384],
                [-1.3,-1.1,30.47,36.49,6,15,3000,3.465,0.7579,0.05328,-0.8435],
                [-1.3,-1.1,36.49,42.52,6,15,3000,1.982,1.148,0.05664,-0.9626],
                [-1.1,-0.8,0,6.37,6,15,3000,-0.8118,0.491,0.03583,-0.7149],
                [-1.1,-0.8,6.37,12.4,6,15,3000,1.289,0.49,0.03539,-0.7073],
                [-1.1,-0.8,12.4,18.42,6,15,3000,1.953,0.5161,0.03658,-0.7295],
                [-1.1,-0.8,18.42,24.45,6,15,3000,2.347,0.5396,0.03576,-0.7339],
                [-1.1,-0.8,24.45,30.47,6,15,3000,2.794,0.5687,0.03825,-0.7602],
                [-1.1,-0.8,30.47,36.49,6,15,3000,2.796,0.7203,0.04074,-0.8431],
                [-1.1,-0.8,36.49,42.52,6,15,3000,3.788,0.6287,0.04156,-0.7959],
                [-0.8,-0.5,0,6.37,6,15,3000,-0.9395,0.4556,0.02738,-0.6909],
                [-0.8,-0.5,6.37,12.4,6,15,3000,1.339,0.4621,0.02785,-0.6965],
                [-0.8,-0.5,12.4,18.42,6,15,3000,1.597,0.5254,0.02952,-0.7407],
                [-0.8,-0.5,18.42,24.45,6,15,3000,2.527,0.5042,0.02842,-0.723],
                [-0.8,-0.5,24.45,30.47,6,15,3000,2.896,0.5428,0.03001,-0.7476],
                [-0.8,-0.5,30.47,36.49,6,15,3000,3.514,0.5437,0.03055,-0.7486],
                [-0.8,-0.5,36.49,42.52,6,15,3000,3.678,0.6372,0.03325,-0.8053],
                [-0.5,0,0,6.37,6,15,3000,-1.515,0.5971,0.03046,-0.7901],
                [-0.5,0,6.37,12.4,6,15,3000,-0.7966,0.6589,0.03119,-0.8237],
                [-0.5,0,12.4,18.42,6,15,3000,1.387,0.6885,0.03145,-0.8378],
                [-0.5,0,18.42,24.45,6,15,3000,2.151,0.7185,0.03168,-0.8502],
                [-0.5,0,24.45,30.47,6,15,3000,2.73,0.7361,0.03184,-0.8548],
                [-0.5,0,30.47,36.49,6,15,3000,3.603,0.7318,0.03227,-0.855],
                [-0.5,0,36.49,42.52,6,15,3000,3.897,0.7882,0.03282,-0.8746],
                [0,0.5,0,6.37,6,15,3000,-1.515,0.5971,0.03046,-0.7901],
                [0,0.5,6.37,12.4,6,15,3000,-0.7966,0.6589,0.03119,-0.8237],
                [0,0.5,12.4,18.42,6,15,3000,1.387,0.6885,0.03145,-0.8378],
                [0,0.5,18.42,24.45,6,15,3000,2.151,0.7185,0.03168,-0.8502],
                [0,0.5,24.45,30.47,6,15,3000,2.73,0.7361,0.03184,-0.8548],
                [0,0.5,30.47,36.49,6,15,3000,3.603,0.7318,0.03227,-0.855],
                [0,0.5,36.49,42.52,6,15,3000,3.897,0.7882,0.03282,-0.8746],
                [0.5,0.8,0,6.37,6,15,3000,-0.9395,0.4556,0.02738,-0.6909],
                [0.5,0.8,6.37,12.4,6,15,3000,1.339,0.4621,0.02785,-0.6965],
                [0.5,0.8,12.4,18.42,6,15,3000,1.597,0.5254,0.02952,-0.7407],
                [0.5,0.8,18.42,24.45,6,15,3000,2.527,0.5042,0.02842,-0.723],
                [0.5,0.8,24.45,30.47,6,15,3000,2.896,0.5428,0.03001,-0.7476],
                [0.5,0.8,30.47,36.49,6,15,3000,3.514,0.5437,0.03055,-0.7486],
                [0.5,0.8,36.49,42.52,6,15,3000,3.678,0.6372,0.03325,-0.8053],
                [0.8,1.1,0,6.37,6,15,3000,-0.8118,0.491,0.03583,-0.7149],
                [0.8,1.1,6.37,12.4,6,15,3000,1.289,0.49,0.03539,-0.7073],
                [0.8,1.1,12.4,18.42,6,15,3000,1.953,0.5161,0.03658,-0.7295],
                [0.8,1.1,18.42,24.45,6,15,3000,2.347,0.5396,0.03576,-0.7339],
                [0.8,1.1,24.45,30.47,6,15,3000,2.794,0.5687,0.03825,-0.7602],
                [0.8,1.1,30.47,36.49,6,15,3000,2.796,0.7203,0.04074,-0.8431],
                [0.8,1.1,36.49,42.52,6,15,3000,3.788,0.6287,0.04156,-0.7959],
                [1.1,1.3,0,6.37,6,15,3000,0.6707,0.5839,0.04697,-0.752],
                [1.1,1.3,6.37,12.4,6,15,3000,1.395,0.6702,0.0496,-0.8152],
                [1.1,1.3,12.4,18.42,6,15,3000,2.43,0.5712,0.04572,-0.7345],
                [1.1,1.3,18.42,24.45,6,15,3000,2.439,0.6623,0.04496,-0.7771],
                [1.1,1.3,24.45,30.47,6,15,3000,3.353,0.5924,0.04617,-0.7384],
                [1.1,1.3,30.47,36.49,6,15,3000,3.465,0.7579,0.05328,-0.8435],
                [1.1,1.3,36.49,42.52,6,15,3000,1.982,1.148,0.05664,-0.9626],
                [1.3,1.7,0,6.37,6,15,3000,-1.469,0.9562,0.05101,-0.955],
                [1.3,1.7,6.37,12.4,6,15,3000,-1.377,1.078,0.05427,-1.003],
                [1.3,1.7,12.4,18.42,6,15,3000,1.501,1.072,0.05498,-1.001],
                [1.3,1.7,18.42,24.45,6,15,3000,1.53,1.158,0.05396,-1.021],
                [1.3,1.7,24.45,30.47,6,15,3000,1.621,1.358,0.0578,-1.078],
                [1.3,1.7,30.47,36.49,6,15,3000,3.163,1.131,0.05725,-0.9809],
                [1.3,1.7,36.49,42.52,6,15,3000,2.818,1.326,0.05893,-0.9977],
                [1.7,1.9,0,6.37,6,15,3000,1.227,0.8407,-0.0232,-0.9284],
                [1.7,1.9,6.37,12.4,6,15,3000,-1.339,1.218,-0.03479,-1.076],
                [1.7,1.9,12.4,18.42,6,15,3000,-2.011,1.435,-0.03565,-1.124],
                [1.7,1.9,18.42,24.45,6,15,3000,3.324,0.8102,-0.02662,-0.8923],
                [1.7,1.9,24.45,30.47,6,15,3000,2.188,1.365,-0.0375,-1.088],
                [1.7,1.9,30.47,36.49,6,15,3000,2.884,1.306,0.03685,-1.038],
                [1.7,1.9,36.49,42.52,6,15,3000,4.03,1.141,0.03059,-0.9262],
                [1.9,2.1,0,6.37,6,15,3000,-1.979,1.193,-0.03497,-1.109],
                [1.9,2.1,6.37,12.4,6,15,3000,-2.528,1.44,-0.03273,-1.143],
                [1.9,2.1,12.4,18.42,6,15,3000,1.95,1.118,-0.03202,-1.054],
                [1.9,2.1,18.42,24.45,6,15,3000,2.377,1.166,-0.03593,-1.061],
                [1.9,2.1,24.45,30.47,6,15,3000,3.122,1.107,-0.0292,-1.005],
                [1.9,2.1,30.47,36.49,6,15,3000,-1.899,1.944,0.03736,-1.185],
                [1.9,2.1,36.49,42.52,6,15,3000,4.168,1.452,0.03836,-1.019],
                [2.1,2.3,0,6.37,6,15,3000,1.947,0.9639,-0.02799,-1.024],
                [2.1,2.3,6.37,12.4,6,15,3000,2.643,0.9054,-0.02701,-0.9753],
                [2.1,2.3,12.4,18.42,6,15,3000,-3.209,2.521,-0.04442,-1.385],
                [2.1,2.3,18.42,24.45,6,15,3000,-5.368,3.81,-0.04587,-1.525],
                [2.1,2.3,24.45,30.47,6,15,3000,-2.344,2.207,0.03446,-1.265],
                [2.1,2.3,30.47,36.49,6,15,3000,-11.01,8.354,0.05639,-1.706],
                [2.1,2.3,36.49,42.52,6,15,3000,6.282,1.064,8.482e-06,-0.8687],
                [2.3,2.5,0,6.37,6,15,3000,3.639,0.6502,-0.01427,-0.8624],
                [2.3,2.5,6.37,12.4,6,15,3000,2.391,1.635,-0.0378,-1.251],
                [2.3,2.5,12.4,18.42,6,15,3000,3.431,1.985,0.04609,-1.359],
                [2.3,2.5,18.42,24.45,6,15,3000,5.095,0.8757,-0.02736,-0.9761],
                [2.3,2.5,24.45,30.47,6,15,3000,5.034,1.479,-0.03479,-1.175],
                [2.3,2.5,30.47,36.49,6,15,3000,6.694,1.325,0.03374,-1.101],
                [2.3,2.5,36.49,42.52,6,15,3000,7.444,1.137,4.258e-05,-0.9531],
                [2.5,2.8,0,6.37,6,15,3000,6.114,0.2385,1.741e-05,-0.5054],
                [2.5,2.8,6.37,12.4,6,15,3000,6.931,0.1964,7.465e-06,-0.4335],
                [2.5,2.8,12.4,18.42,6,15,3000,7.858,0.2435,6.026e-07,-0.5235],
                [2.5,2.8,18.42,24.45,6,15,3000,8.713,0.1314,8.441e-06,-0.3028],
                [2.5,2.8,24.45,30.47,6,15,3000,9.413,0.2792,1.217e-06,-0.5729],
                [2.5,2.8,30.47,36.49,6,15,3000,10.51,0.1659,1.277e-06,-0.4276],
                [2.5,2.8,36.49,42.52,6,15,3000,11.77,8.547e-07,0.05169,-1.197],
                [2.8,3,0,6.37,6,15,3000,6.048,0.1992,-3.559e-06,-0.2953],
                [2.8,3,6.37,12.4,6,15,3000,6.867,0.2036,1.946e-05,-0.3068],
                [2.8,3,12.4,18.42,6,15,3000,8.198,0.0001314,0.08772,-1.252],
                [2.8,3,18.42,24.45,6,15,3000,8.756,0.134,-0.07197,-0.2968],
                [2.8,3,24.45,30.47,6,15,3000,9.615,0.0001533,-0.08793,-1.445],
                [2.8,3,30.47,36.49,6,15,3000,10.01,0.1524,3.815e-05,-0.2422],
                [2.8,3,36.49,42.52,6,15,3000,10.05,0.1932,0.0001734,-0.2739],
                [3,3.2,0,6.37,6,15,3000,-35.12,35.21,0.1466,-1.993],
                [3,3.2,6.37,12.4,6,15,3000,6.573,0.2026,6.573e-05,-0.1564],
                [3,3.2,12.4,18.42,6,15,3000,0.004144,6.019,0.1549,-1.854],
                [3,3.2,18.42,24.45,6,15,3000,8.341,0.0001012,0.1526,-1.689],
                [3,3.2,24.45,30.47,6,15,3000,9.115,0.0002242,0.1518,-1.362],
                [3,3.2,30.47,36.49,6,15,3000,9.86,-2.112e-05,0.1438,-1.114],
                [3,3.2,36.49,42.52,6,15,3000,10.45,0.0001536,0.1398,-1.271],
                [3.2,4.7,0,6.37,6,15,3000,-29.87,29.84,0.1045,-1.995],
                [3.2,4.7,6.37,12.4,6,15,3000,-23.2,23.09,0.1051,-1.987],
                [3.2,4.7,12.4,18.42,6,15,3000,4.337,0.2253,0.06986,-0.4215],
                [3.2,4.7,18.42,24.45,6,15,3000,4.088,2.746,0.1136,-1.959],
                [3.2,4.7,24.45,30.47,6,15,3000,5.624,0.1291,0.002663,-0.04825],
                [3.2,4.7,30.47,36.49,6,15,3000,6.152,6.125e-05,0.1128,-1.319],
                [3.2,4.7,36.49,42.52,6,15,3000,6.235,0.1408,0.0001266,-0.08163],
                    ]
            self.formula =  ROOT.TFormula("f", "sqrt([0]*abs([0])/(x*x)+[1]*[1]*pow(x,[3])+[2]*[2])")
            self.rhoMin = 0.0
            self.rhoMax = 42.52
        elif self.year == 2016:
            # from https://github.com/cms-jet/JRDatabase/blob/master/textFiles/Summer16_25nsV1_DATA/Summer16_25nsV1_DATA_PtResolution_AK4PFchs.txt
            self.table = [
                [-4.7,-3.2,0,6.69,6,15,3000,2.511,0.3167,0.09085,-0.7407],
                [-4.7,-3.2,6.69,12.39,6,15,3000,3.297,0.2091,6.258e-05,-0.2755],
                [-4.7,-3.2,12.39,18.09,6,15,3000,1.85,2.281,0.1042,-1.635],
                [-4.7,-3.2,18.09,23.79,6,15,3000,3.869,1.001,0.09955,-1.266],
                [-4.7,-3.2,23.79,29.49,6,15,3000,-23.98,24.11,0.1057,-1.988],
                [-4.7,-3.2,29.49,35.19,6,15,3000,5.403,0.2371,1.5e-05,-0.3177],
                [-4.7,-3.2,35.19,40.9,6,15,3000,5.753,0.2337,0.0002982,-0.3108],
                [-3.2,-3,0,6.69,6,15,3000,0.0002851,3.01,0.1382,-1.702],
                [-3.2,-3,6.69,12.39,6,15,3000,-33.01,33.04,0.1343,-1.991],
                [-3.2,-3,12.39,18.09,6,15,3000,-67.94,67.8,0.1342,-1.996],
                [-3.2,-3,18.09,23.79,6,15,3000,-47.81,48,0.1391,-1.996],
                [-3.2,-3,23.79,29.49,6,15,3000,7.162,0.9211,0.1395,-1.209],
                [-3.2,-3,29.49,35.19,6,15,3000,8.193,0.1995,2.822e-05,-0.132],
                [-3.2,-3,35.19,40.9,6,15,3000,8.133,0.9983,0.1349,-1.181],
                [-3,-2.8,0,6.69,6,15,3000,4.467,0.1997,-3.491e-06,-0.2623],
                [-3,-2.8,6.69,12.39,6,15,3000,4.17,0.928,0.07702,-1.063],
                [-3,-2.8,12.39,18.09,6,15,3000,-0.04491,3.67,0.08704,-1.641],
                [-3,-2.8,18.09,23.79,6,15,3000,5.528,1.286,0.07962,-1.187],
                [-3,-2.8,23.79,29.49,6,15,3000,-78.36,78.23,0.08448,-1.996],
                [-3,-2.8,29.49,35.19,6,15,3000,7.559,1.147,0.07023,-1.134],
                [-3,-2.8,35.19,40.9,6,15,3000,-59.03,59.03,-0.08184,-1.992],
                [-2.8,-2.5,0,6.69,6,15,3000,4.244,0.2766,-1.86e-08,-0.5068],
                [-2.8,-2.5,6.69,12.39,6,15,3000,4.919,0.3193,5.463e-06,-0.58],
                [-2.8,-2.5,12.39,18.09,6,15,3000,5.909,0.2752,4.144e-06,-0.5272],
                [-2.8,-2.5,18.09,23.79,6,15,3000,-47.31,47.18,0.05853,-1.991],
                [-2.8,-2.5,23.79,29.49,6,15,3000,-46.49,46.33,0.05698,-1.989],
                [-2.8,-2.5,29.49,35.19,6,15,3000,8.651,0.2522,6.592e-06,-0.4835],
                [-2.8,-2.5,35.19,40.9,6,15,3000,7.716,2.481,0.0531,-1.455],
                [-2.5,-2.3,0,6.69,6,15,3000,3.125,0.6026,0.02576,-0.8702],
                [-2.5,-2.3,6.69,12.39,6,15,3000,3.935,0.6533,0.02587,-0.889],
                [-2.5,-2.3,12.39,18.09,6,15,3000,4.198,1.024,0.03618,-1.069],
                [-2.5,-2.3,18.09,23.79,6,15,3000,2.948,2.386,0.04771,-1.382],
                [-2.5,-2.3,23.79,29.49,6,15,3000,4.415,2.086,0.04704,-1.294],
                [-2.5,-2.3,29.49,35.19,6,15,3000,-3.084,4.156,0.05366,-1.503],
                [-2.5,-2.3,35.19,40.9,6,15,3000,-6.144,5.969,0.05633,-1.602],
                [-2.3,-2.1,0,6.69,6,15,3000,0.3022,1.127,0.03826,-1.134],
                [-2.3,-2.1,6.69,12.39,6,15,3000,2.161,1.217,0.03826,-1.142],
                [-2.3,-2.1,12.39,18.09,6,15,3000,3.218,1.21,0.03662,-1.112],
                [-2.3,-2.1,18.09,23.79,6,15,3000,3.328,1.638,0.04398,-1.216],
                [-2.3,-2.1,23.79,29.49,6,15,3000,5.506,1.173,0.04403,-1.054],
                [-2.3,-2.1,29.49,35.19,6,15,3000,-2.444,3.613,0.05639,-1.437],
                [-2.3,-2.1,35.19,40.9,6,15,3000,2.217,3.133,0.05032,-1.338],
                [-2.1,-1.9,0,6.69,6,15,3000,1.184,0.8944,0.03233,-1.005],
                [-2.1,-1.9,6.69,12.39,6,15,3000,1.691,1.124,0.03736,-1.094],
                [-2.1,-1.9,12.39,18.09,6,15,3000,2.837,1.077,0.03437,-1.046],
                [-2.1,-1.9,18.09,23.79,6,15,3000,2.459,1.589,-0.04007,-1.18],
                [-2.1,-1.9,23.79,29.49,6,15,3000,4.058,1.369,-0.03922,-1.087],
                [-2.1,-1.9,29.49,35.19,6,15,3000,4.231,1.679,0.0432,-1.13],
                [-2.1,-1.9,35.19,40.9,6,15,3000,2.635,2.648,0.04929,-1.28],
                [-1.9,-1.7,0,6.69,6,15,3000,-0.8823,1.092,0.03599,-1.062],
                [-1.9,-1.7,6.69,12.39,6,15,3000,2.193,0.9891,0.03382,-1.012],
                [-1.9,-1.7,12.39,18.09,6,15,3000,2.9,1.043,0.03477,-1.019],
                [-1.9,-1.7,18.09,23.79,6,15,3000,2.371,1.488,-0.04053,-1.145],
                [-1.9,-1.7,23.79,29.49,6,15,3000,3.75,1.458,0.04346,-1.122],
                [-1.9,-1.7,29.49,35.19,6,15,3000,3.722,1.808,0.04668,-1.177],
                [-1.9,-1.7,35.19,40.9,6,15,3000,4.836,1.47,0.03875,-1.047],
                [-1.7,-1.3,0,6.69,6,15,3000,-1.692,1.192,0.05049,-1.06],
                [-1.7,-1.3,6.69,12.39,6,15,3000,-1.804,1.48,0.05315,-1.145],
                [-1.7,-1.3,12.39,18.09,6,15,3000,1.673,1.402,0.0536,-1.116],
                [-1.7,-1.3,18.09,23.79,6,15,3000,2.906,1.305,0.05377,-1.076],
                [-1.7,-1.3,23.79,29.49,6,15,3000,2.766,1.613,0.05511,-1.137],
                [-1.7,-1.3,29.49,35.19,6,15,3000,3.409,1.746,0.05585,-1.143],
                [-1.7,-1.3,35.19,40.9,6,15,3000,3.086,2.034,0.05795,-1.181],
                [-1.3,-1.1,0,6.69,6,15,3000,-0.7275,0.8099,0.04885,-0.9097],
                [-1.3,-1.1,6.69,12.39,6,15,3000,1.829,0.8156,0.04991,-0.9145],
                [-1.3,-1.1,12.39,18.09,6,15,3000,2.72,0.8454,0.05036,-0.9215],
                [-1.3,-1.1,18.09,23.79,6,15,3000,3.07,0.9201,0.05067,-0.9439],
                [-1.3,-1.1,23.79,29.49,6,15,3000,3.991,0.8715,0.05041,-0.9151],
                [-1.3,-1.1,29.49,35.19,6,15,3000,4.001,1.14,0.05214,-0.9987],
                [-1.3,-1.1,35.19,40.9,6,15,3000,4.522,1.22,0.05122,-1],
                [-1.1,-0.8,0,6.69,6,15,3000,1.423,0.4736,0.03233,-0.7093],
                [-1.1,-0.8,6.69,12.39,6,15,3000,2.249,0.5041,0.03355,-0.7316],
                [-1.1,-0.8,12.39,18.09,6,15,3000,2.961,0.4889,0.03129,-0.7091],
                [-1.1,-0.8,18.09,23.79,6,15,3000,3.4,0.5757,0.03541,-0.7742],
                [-1.1,-0.8,23.79,29.49,6,15,3000,3.884,0.6457,0.03731,-0.8146],
                [-1.1,-0.8,29.49,35.19,6,15,3000,4.433,0.7524,0.03962,-0.8672],
                [-1.1,-0.8,35.19,40.9,6,15,3000,4.681,0.9075,0.04182,-0.9304],
                [-0.8,-0.5,0,6.69,6,15,3000,1.003,0.4142,0.02486,-0.6698],
                [-0.8,-0.5,6.69,12.39,6,15,3000,2.134,0.3971,0.02264,-0.6469],
                [-0.8,-0.5,12.39,18.09,6,15,3000,2.66,0.4566,0.02755,-0.7058],
                [-0.8,-0.5,18.09,23.79,6,15,3000,3.264,0.4799,0.02702,-0.7156],
                [-0.8,-0.5,23.79,29.49,6,15,3000,3.877,0.5249,0.02923,-0.7479],
                [-0.8,-0.5,29.49,35.19,6,15,3000,4.441,0.581,0.03045,-0.7804],
                [-0.8,-0.5,35.19,40.9,6,15,3000,4.742,0.8003,0.03613,-0.9062],
                [-0.5,0,0,6.69,6,15,3000,0.6172,0.3908,0.02003,-0.6407],
                [-0.5,0,6.69,12.39,6,15,3000,1.775,0.4231,0.02199,-0.6701],
                [-0.5,0,12.39,18.09,6,15,3000,2.457,0.4626,0.02416,-0.7045],
                [-0.5,0,18.09,23.79,6,15,3000,2.996,0.5242,0.02689,-0.7508],
                [-0.5,0,23.79,29.49,6,15,3000,3.623,0.5591,0.0288,-0.7747],
                [-0.5,0,29.49,35.19,6,15,3000,4.167,0.6365,0.03045,-0.8179],
                [-0.5,0,35.19,40.9,6,15,3000,4.795,0.6819,0.03145,-0.8408],
                [0,0.5,0,6.69,6,15,3000,0.6172,0.3908,0.02003,-0.6407],
                [0,0.5,6.69,12.39,6,15,3000,1.775,0.4231,0.02199,-0.6701],
                [0,0.5,12.39,18.09,6,15,3000,2.457,0.4626,0.02416,-0.7045],
                [0,0.5,18.09,23.79,6,15,3000,2.996,0.5242,0.02689,-0.7508],
                [0,0.5,23.79,29.49,6,15,3000,3.623,0.5591,0.0288,-0.7747],
                [0,0.5,29.49,35.19,6,15,3000,4.167,0.6365,0.03045,-0.8179],
                [0,0.5,35.19,40.9,6,15,3000,4.795,0.6819,0.03145,-0.8408],
                [0.5,0.8,0,6.69,6,15,3000,1.003,0.4142,0.02486,-0.6698],
                [0.5,0.8,6.69,12.39,6,15,3000,2.134,0.3971,0.02264,-0.6469],
                [0.5,0.8,12.39,18.09,6,15,3000,2.66,0.4566,0.02755,-0.7058],
                [0.5,0.8,18.09,23.79,6,15,3000,3.264,0.4799,0.02702,-0.7156],
                [0.5,0.8,23.79,29.49,6,15,3000,3.877,0.5249,0.02923,-0.7479],
                [0.5,0.8,29.49,35.19,6,15,3000,4.441,0.581,0.03045,-0.7804],
                [0.5,0.8,35.19,40.9,6,15,3000,4.742,0.8003,0.03613,-0.9062],
                [0.8,1.1,0,6.69,6,15,3000,1.423,0.4736,0.03233,-0.7093],
                [0.8,1.1,6.69,12.39,6,15,3000,2.249,0.5041,0.03355,-0.7316],
                [0.8,1.1,12.39,18.09,6,15,3000,2.961,0.4889,0.03129,-0.7091],
                [0.8,1.1,18.09,23.79,6,15,3000,3.4,0.5757,0.03541,-0.7742],
                [0.8,1.1,23.79,29.49,6,15,3000,3.884,0.6457,0.03731,-0.8146],
                [0.8,1.1,29.49,35.19,6,15,3000,4.433,0.7524,0.03962,-0.8672],
                [0.8,1.1,35.19,40.9,6,15,3000,4.681,0.9075,0.04182,-0.9304],
                [1.1,1.3,0,6.69,6,15,3000,-0.7275,0.8099,0.04885,-0.9097],
                [1.1,1.3,6.69,12.39,6,15,3000,1.829,0.8156,0.04991,-0.9145],
                [1.1,1.3,12.39,18.09,6,15,3000,2.72,0.8454,0.05036,-0.9215],
                [1.1,1.3,18.09,23.79,6,15,3000,3.07,0.9201,0.05067,-0.9439],
                [1.1,1.3,23.79,29.49,6,15,3000,3.991,0.8715,0.05041,-0.9151],
                [1.1,1.3,29.49,35.19,6,15,3000,4.001,1.14,0.05214,-0.9987],
                [1.1,1.3,35.19,40.9,6,15,3000,4.522,1.22,0.05122,-1],
                [1.3,1.7,0,6.69,6,15,3000,-1.692,1.192,0.05049,-1.06],
                [1.3,1.7,6.69,12.39,6,15,3000,-1.804,1.48,0.05315,-1.145],
                [1.3,1.7,12.39,18.09,6,15,3000,1.673,1.402,0.0536,-1.116],
                [1.3,1.7,18.09,23.79,6,15,3000,2.906,1.305,0.05377,-1.076],
                [1.3,1.7,23.79,29.49,6,15,3000,2.766,1.613,0.05511,-1.137],
                [1.3,1.7,29.49,35.19,6,15,3000,3.409,1.746,0.05585,-1.143],
                [1.3,1.7,35.19,40.9,6,15,3000,3.086,2.034,0.05795,-1.181],
                [1.7,1.9,0,6.69,6,15,3000,-0.8823,1.092,0.03599,-1.062],
                [1.7,1.9,6.69,12.39,6,15,3000,2.193,0.9891,0.03382,-1.012],
                [1.7,1.9,12.39,18.09,6,15,3000,2.9,1.043,0.03477,-1.019],
                [1.7,1.9,18.09,23.79,6,15,3000,2.371,1.488,-0.04053,-1.145],
                [1.7,1.9,23.79,29.49,6,15,3000,3.75,1.458,0.04346,-1.122],
                [1.7,1.9,29.49,35.19,6,15,3000,3.722,1.808,0.04668,-1.177],
                [1.7,1.9,35.19,40.9,6,15,3000,4.836,1.47,0.03875,-1.047],
                [1.9,2.1,0,6.69,6,15,3000,1.184,0.8944,0.03233,-1.005],
                [1.9,2.1,6.69,12.39,6,15,3000,1.691,1.124,0.03736,-1.094],
                [1.9,2.1,12.39,18.09,6,15,3000,2.837,1.077,0.03437,-1.046],
                [1.9,2.1,18.09,23.79,6,15,3000,2.459,1.589,-0.04007,-1.18],
                [1.9,2.1,23.79,29.49,6,15,3000,4.058,1.369,-0.03922,-1.087],
                [1.9,2.1,29.49,35.19,6,15,3000,4.231,1.679,0.0432,-1.13],
                [1.9,2.1,35.19,40.9,6,15,3000,2.635,2.648,0.04929,-1.28],
                [2.1,2.3,0,6.69,6,15,3000,0.3022,1.127,0.03826,-1.134],
                [2.1,2.3,6.69,12.39,6,15,3000,2.161,1.217,0.03826,-1.142],
                [2.1,2.3,12.39,18.09,6,15,3000,3.218,1.21,0.03662,-1.112],
                [2.1,2.3,18.09,23.79,6,15,3000,3.328,1.638,0.04398,-1.216],
                [2.1,2.3,23.79,29.49,6,15,3000,5.506,1.173,0.04403,-1.054],
                [2.1,2.3,29.49,35.19,6,15,3000,-2.444,3.613,0.05639,-1.437],
                [2.1,2.3,35.19,40.9,6,15,3000,2.217,3.133,0.05032,-1.338],
                [2.3,2.5,0,6.69,6,15,3000,3.125,0.6026,0.02576,-0.8702],
                [2.3,2.5,6.69,12.39,6,15,3000,3.935,0.6533,0.02587,-0.889],
                [2.3,2.5,12.39,18.09,6,15,3000,4.198,1.024,0.03618,-1.069],
                [2.3,2.5,18.09,23.79,6,15,3000,2.948,2.386,0.04771,-1.382],
                [2.3,2.5,23.79,29.49,6,15,3000,4.415,2.086,0.04704,-1.294],
                [2.3,2.5,29.49,35.19,6,15,3000,-3.084,4.156,0.05366,-1.503],
                [2.3,2.5,35.19,40.9,6,15,3000,-6.144,5.969,0.05633,-1.602],
                [2.5,2.8,0,6.69,6,15,3000,4.244,0.2766,-1.86e-08,-0.5068],
                [2.5,2.8,6.69,12.39,6,15,3000,4.919,0.3193,5.463e-06,-0.58],
                [2.5,2.8,12.39,18.09,6,15,3000,5.909,0.2752,4.144e-06,-0.5272],
                [2.5,2.8,18.09,23.79,6,15,3000,-47.31,47.18,0.05853,-1.991],
                [2.5,2.8,23.79,29.49,6,15,3000,-46.49,46.33,0.05698,-1.989],
                [2.5,2.8,29.49,35.19,6,15,3000,8.651,0.2522,6.592e-06,-0.4835],
                [2.5,2.8,35.19,40.9,6,15,3000,7.716,2.481,0.0531,-1.455],
                [2.8,3,0,6.69,6,15,3000,4.467,0.1997,-3.491e-06,-0.2623],
                [2.8,3,6.69,12.39,6,15,3000,4.17,0.928,0.07702,-1.063],
                [2.8,3,12.39,18.09,6,15,3000,-0.04491,3.67,0.08704,-1.641],
                [2.8,3,18.09,23.79,6,15,3000,5.528,1.286,0.07962,-1.187],
                [2.8,3,23.79,29.49,6,15,3000,-78.36,78.23,0.08448,-1.996],
                [2.8,3,29.49,35.19,6,15,3000,7.559,1.147,0.07023,-1.134],
                [2.8,3,35.19,40.9,6,15,3000,-59.03,59.03,-0.08184,-1.992],
                [3,3.2,0,6.69,6,15,3000,0.0002851,3.01,0.1382,-1.702],
                [3,3.2,6.69,12.39,6,15,3000,-33.01,33.04,0.1343,-1.991],
                [3,3.2,12.39,18.09,6,15,3000,-67.94,67.8,0.1342,-1.996],
                [3,3.2,18.09,23.79,6,15,3000,-47.81,48,0.1391,-1.996],
                [3,3.2,23.79,29.49,6,15,3000,7.162,0.9211,0.1395,-1.209],
                [3,3.2,29.49,35.19,6,15,3000,8.193,0.1995,2.822e-05,-0.132],
                [3,3.2,35.19,40.9,6,15,3000,8.133,0.9983,0.1349,-1.181],
                [3.2,4.7,0,6.69,6,15,3000,2.511,0.3167,0.09085,-0.7407],
                [3.2,4.7,6.69,12.39,6,15,3000,3.297,0.2091,6.258e-05,-0.2755],
                [3.2,4.7,12.39,18.09,6,15,3000,1.85,2.281,0.1042,-1.635],
                [3.2,4.7,18.09,23.79,6,15,3000,3.869,1.001,0.09955,-1.266],
                [3.2,4.7,23.79,29.49,6,15,3000,-23.98,24.11,0.1057,-1.988],
                [3.2,4.7,29.49,35.19,6,15,3000,5.403,0.2371,1.5e-05,-0.3177],
                [3.2,4.7,35.19,40.9,6,15,3000,5.753,0.2337,0.0002982,-0.3108],
                ]
            self.formula =  ROOT.TFormula("f", "sqrt([0]*abs([0])/(x*x)+[1]*[1]*pow(x,[3])+[2]*[2])")
            self.rhoMin = 0.0
            self.rhoMax = 40.9
        else:
            print("ERROR: year=", self.year, "is unknown.")
            raise Exception("JMEResError")


    def eval(self, eta, rho, pt):
        eta = max(min(eta, 4.7), -4.7)
        rho = max(min(rho, self.rhoMax), self.rhoMin)

        for line in self.table:
            if eta >= line[0] and eta <= line[1] and rho >= line[2] and rho <= line[3]:
                assert line[4] == 6
                pt = max(min(pt, line[6]), line[5])
                self.formula.SetParameter(0, line[7])
                self.formula.SetParameter(1, line[8])
                self.formula.SetParameter(2, line[9])
                self.formula.SetParameter(3, line[10])
                return self.formula.Eval(pt)
        print("ERROR:", eta, rho, pt)
        raise Exception("JMEResError")

if __name__ == "__main__":
    for year in [2016, 2017, 2018]:
        jmeRes = JMEres(year=year)
        print("res",year,"is", jmeRes.eval(0.8, 30.0, 12.0))
        print("res",year,"is", jmeRes.eval(0.8, 30.0, 123.0))
        print("res",year,"is", jmeRes.eval(0.8, 30.0, 1230.0))
        print("res",year,"is", jmeRes.eval(0.8, 30.0, 12300.0))
        print("res",year,"is", jmeRes.eval(4.8, 50.0, 50.0))


